add more comments
clean up code

